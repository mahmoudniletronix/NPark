<div
  class="parking container-fluid"
  [attr.dir]="lang.dir()"
  [class.page-rtl]="lang.isRTL()"
  [class.page-ltr]="!lang.isRTL()"
>
  <div class="row g-4">
    <div class="col-12 col-xxl-8">
      <div class="card card--glass shadow-sm h-100">
        <div class="card-header d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-2">
            <i class="bi bi-bezier2"></i>
            <h5 class="mb-0 fw-bold">{{ 'garageMap' | t }}</h5>
          </div>

          <div class="controls d-flex align-items-center gap-2">
            <!-- استخراج JSON -->
            <button
              type="button"
              class="btn btn-primary btn-sm"
              (click)="exportJson()"
              [disabled]="!svgEl"
              [title]="'titleExport' | t"
            >
              {{ 'exportJson' | t }}
            </button>

            <!-- زووم وتحكم -->
            <div class="btn-group">
              <button
                type="button"
                class="btn btn-outline btn-sm"
                (click)="zoomOut()"
                [disabled]="!svgEl"
                [title]="'titleZoomOut' | t"
              >
                −
              </button>
              <button
                type="button"
                class="btn btn-outline btn-sm"
                (click)="resetView()"
                [disabled]="!svgEl"
                [title]="'titleReset' | t"
              >
                ⟳
              </button>
              <button
                type="button"
                class="btn btn-outline btn-sm"
                (click)="zoomIn()"
                [disabled]="!svgEl"
                [title]="'titleZoomIn' | t"
              >
                +
              </button>
            </div>

            <select
              class="form-select form-select-sm"
              (change)="onMapChange($event)"
              [disabled]="!svgEl"
            >
              <option value="B1">{{ 'planB1' | t }}</option>
              <option value="B2">{{ 'planB2' | t }}</option>
            </select>
          </div>
        </div>

        <div class="card-body p-0">
          <div class="svg-wrap">
            <div #svgHost class="svg-host" [innerHTML]="sanitizedSvg"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-xxl-4">
      <div class="card card--glass shadow-sm h-100">
        <div class="card-header">
          <h6 class="mb-0 fw-bold">{{ 'quickControl' | t }}</h6>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">{{ 'searchById' | t }}</label>
            <input
              class="form-control"
              [placeholder]="'searchExample' | t"
              (input)="onSearchInput($event)"
            />
            <small class="text-muted">{{ 'searchHint' | t }}</small>
          </div>

          <div class="row g-2 align-items-end">
            <div class="col-7">
              <label class="form-label">{{ 'slotId' | t }}</label>
              <input
                class="form-control"
                [placeholder]="'slotIdExample' | t"
                (input)="onSlotIdInput($event)"
              />
            </div>
            <div class="col-5">
              <label class="form-label">{{ 'status' | t }}</label>
              <select class="form-select" (change)="onStatusChange($event)">
                <option value="free">{{ 'free' | t }}</option>
                <option value="occupied">{{ 'occupied' | t }}</option>
                <option value="reserved">{{ 'reserved' | t }}</option>
                <option value="disabled">{{ 'disabled' | t }}</option>
              </select>
            </div>
            <div class="col-12">
              <button class="btn btn-danger w-100" (click)="applyStatusByLabel()">
                {{ 'applyToMap' | t }}
              </button>
              <small class="text-muted d-block mt-1">
                {{ 'clickTip' | t }}
              </small>
            </div>
          </div>

          <hr />

          <h6 class="fw-bold mb-2">{{ 'stats' | t }}</h6>
          <ul class="kpis">
            <li>
              <span class="dot dot--free"></span>{{ 'freeLbl' | t }}: <b>{{ freeCount() }}</b>
            </li>
            <li>
              <span class="dot dot--occupied"></span>{{ 'occupiedLbl' | t }}:
              <b>{{ occupiedCount() }}</b>
            </li>
            <li>
              <span class="dot dot--reserved"></span>{{ 'reservedLbl' | t }}:
              <b>{{ reservedCount() }}</b>
            </li>
            <li>
              <span class="dot dot--disabled"></span>{{ 'disabledLbl' | t }}:
              <b>{{ disabledCount() }}</b>
            </li>
          </ul>

          <div class="hint mt-2">
            {{ 'mouseHint' | t }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
